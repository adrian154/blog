<!DOCTYPE html>
<html>
    <body style="background-color: #ccc">
        <canvas id="image" width="256" height="256"></canvas>
        <script>
            const canvas = document.getElementById("image");
            const ctx = canvas.getContext("2d");

            const data = [170,153,160,167,154,154,154,159,168,169,138,103,90,100,142,155,185,140,70,39,30,39,72,138,161,93,78,29,79,132,68,97,99,66,104,18,58,130,91,114,97,23,93,80,81,78,80,162,131,81,52,73,68,73,144,172,131,171,149,116,118,153,159,136]

            const ijg = [
  [16,  11,  10,  16,  24,  40,  51,  61],
  [12,  12,  14,  19,  26,  58,  60,  55],
  [14,  13,  16,  24,  40,  57,  69,  56],
  [14,  17,  22,  29,  51,  87,  80,  62],
  [18,  22,  37,  56,  68, 109, 103,  77],
  [24,  35,  55,  64,  81, 104, 113,  92],
  [49,  64,  78,  87, 103, 121, 120, 101],
  [72,  92,  95,  98, 112, 100, 103,  99]
            ]

            const dct = (i, j) => {
                let sum = 0;
                for(let x = 0; x < 8; x++) {
                    for(let y = 0; y < 8; y++) {
                        const real = Math.cos((2*x+1)*i*Math.PI/16) * Math.cos((2*y+1)*j*Math.PI/16);
                        sum += (data[y * 8 + x] - 128) * real;        
                    }
                }
                return 1 / Math.sqrt(2 * 8) * (i==0?1/Math.sqrt(2):1) * (j==0?1/Math.sqrt(2):1) * sum;
            };

            const coeffs = new Array(8).fill().map(_=>new Array(8));
            let min = Infinity, max = -Infinity;
            
            for(let i = 0; i < 8; i++) {
                for(let j = 0; j < 8; j++) {
                    const value = Math.round(dct(i, j));
                    coeffs[i][j] = Math.trunc(value / ijg[i][j]);
                }
            }

            const arr2table = arr => {
                str = "<table>";
                for(const row of arr) {
                    str += "<tr>";
                    for(const value of row) {
                        str += `<td>${value}</td>`;
                    }
                    str += "</tr>";
                }
                str += "</table>"
                return str
            };

            console.log(arr2table(coeffs));
            console.log(arr2table(ijg));

        </script>
    </body>
</html>