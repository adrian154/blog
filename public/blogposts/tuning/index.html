<!DOCTYPE html><html lang="en" class="serif"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>The Trouble with Tuning Systems</title><meta property="og:title" content="The Trouble with Tuning Systems"><meta property="og:type" content="website"><meta property="og:description" content="Exploring the mathematical conundrum behind harmony"><meta name="description" content="Exploring the mathematical conundrum behind harmony"><link rel="stylesheet" href="/stylesheets/highlight-style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><link rel="stylesheet" href="/stylesheets/main.css"><link rel="preconnect" href="https://rsms.me/"><link rel="stylesheet" href="https://rsms.me/inter/inter.css"><script>const loadSetting = name => {
    if(localStorage.getItem(name) === "true")
        document.documentElement.classList.add(name);
    else
        document.documentElement.classList.remove(name);
};

loadSetting("serif");
loadSetting("darkmode");</script><script defer src="/scripts/ui.js"></script><link rel="icon" type="image/png" sizes="16x16" href="/favicon.png"><link rel="canonical" href="https://blog.bithole.dev/blogposts/tuning"></head><body><header><h1 id="post-title">The Trouble with Tuning Systems</h1><p class="date">Published April 19, 2023 &bull; <a href="/">more posts</a></p></header><main><noscript><p style="color: #ff0000">Warning: If you are seeing this message, JS isn't supported; unfortunately, since this page relies on JS to dynamically generate content, parts of the page may be missing or brutally disfigured.</p></noscript><p>You can tuna fish, but you can&#39;t tune a piano. Wait, what?</p>
<p>Okay, that&#39;s not quite true. You <em>can</em> tune a piano, but only approximately. It turns out that the mathematics behind the 12-tone scale used in most Western music hides some sinister secrets.</p>
<p>Let&#39;s start with the basics. Behind every key on a piano are 1&ndash;3 strings, which have been tensioned so that when the strings are struck they will ring out at a specific frequency. Each note is associated with a distinct frequency, and keys are arranged such that the pitch of the notes increases from left to right.</p>
<p>So what determines the frequency of each key? In a nutshell, we start from a reference note which we assign a specific frequency to, and figure out the frequency of the rest of the notes based on their harmonic relationships. The initial note is known as the <em>pitch standard</em>. In modern times, the most common pitch standard is A<sub>4</sub> = 440 Hz, or just A440.</p>
<p>This is what A<sub>4</sub> sounds like on my piano:</p>
<p><audio controls src="a4.mp3"></audio></p>
<p>Ironically, my piano is pretty badly out of tune, but that doesn&#39;t matter for this demonstration. I can use <a href="https://en.wikipedia.org/wiki/Fourier_transform">a bit of math</a> to take the sound and dissect it into the individual frequencies that make it up, kind of like how a prism can split light into its color components. Here is the resulting spectrum:</p>
<figure>
    <img loading="lazy" src="spectrum.png" alt="spectral power distribution of piano note">
    <figcaption>Disclaimer: the y-axis is a log scale.</figcaption>
</figure>

<p>There&#39;s a big peak representing the fundamental frequency, but there are also a bunch of extra peaks, which are known as overtones or partials. Notice that the peaks are evenly spaced! This is a result of the physics of standing waves: whenever a wave is confined to a finite space, the resulting pattern of oscillation will be the sum of a series of <em>normal modes</em>, whose frequencies are integer multiples of the fundamental frequency. In this case, we see overtones at 880 Hz, 1320 Hz, 1760 Hz, and so on. The fundamental frequency and its overtones form the <em>harmonic series</em>.</p>
<p>The same phenomenon is actually exhibited by many other oscillating systems besides strings. For example, air in a tube is also confined to resonating at multiples of the tube&#39;s fundamental frequency. This is why, for a given fingering, a French horn player is restricted to playing notes within the harmonic series. In fact, even the quartz oscillators that are so ubiquitous in modern electronics can be made to vibrate at a multiple of its fundamental frequency.</p>
<p>The harmonic series is crucial to the Western tradition of music, where notes that share a lot of overtones are generally perceived as more consonant (as opposed to dissonant). As a result, the relationships between successive members of the harmonic series essentially serve as the building blocks of harmony, and they&#39;ve been assigned names to reflect their importance.</p>
<p>Try it for yourself&mdash;click the Play button to hear the intervals formed by the harmonic series!</p>
<p><button onclick="play()">Play</button></p>
<p><canvas id="harmonics" width="640" height="500"></canvas></p>
<script src="main.js"></script>

<p>Okay, so we&#39;re making some real progress. We know from the <a href="https://en.wikipedia.org/wiki/Circle_of_fifths">circle of fifths</a> that we can start from any note and advance in perfect fifths to cycle through the other 12 notes before returning to the starting note. This is the idea behind <a href="https://en.wikipedia.org/wiki/Pythagorean_tuning">Pythagorean tuning</a>.</p>
<p>If you actually try this, you will realize that it doesn&#39;t quite work. We saw in the previous demo that a perfect fifth is represented by a frequency ratio of 3:2. So if we multiply the frequency of a note by 3/2 twelve times, we would expect to come back to the same note a few octaves up. Yet (3/2)<sup>12</sup> is approximately 129.746, which is not a power of two!</p>
<p>The reason for this is mathematical. The square root of two is irrational, meaning that it is impossible to create it by multiplying together rational numbers like 3/2. In fact, pretty much all the intervals are <em>slightly</em> wrong. The problem becomes very apparent when you try to play chords using our DIY tuning system:</p>
<p><button onclick="playChordPythagorean()">Play Chord</button></p>
<p>The rapid warbling sound you hear is an acoustic phenomenon known as <a href="https://en.wikipedia.org/wiki/Beat_(acoustics)">beating</a>, which occurs when two tones that are slightly out of tune are played together. (This may be hard to hear without headphones). For reference, here&#39;s what the same chord sounds like if we calculate the frequency of the other two notes based on the root note times the frequency ratios we figured out earlier:</p>
<p><button onclick="playChordPerfect()">Play Chord</button></p>
<p>Essentially, the problem is that a note&#39;s exact frequency may vary depending on what interval it&#39;s in. This is less a problem if you play an instrument where you have full control over what pitch is being played, but on a piano, the frequencies of each note are fixed. Thus, it is impossible to tune a piano such that every interval remains pure. </p>
<p>Well. What do we do, then?</p>
<h1 id="the-quotsolutionquot">The &quot;Solution&quot; <a class="section-link" href="#the-quotsolutionquot">&sect;</a></h1><p>Over the centuries, a littany of different tuning systems have been devised to deal with this problem. Each system dealt with the unavoidable compromises of harmony in different ways to suit the needs of composers of their time, and in turn, their limitations influenced how music was written. However, in the modern era, one particular scheme has come to dominate music: <strong>equal temperament</strong>. What&#39;s a temperament? I think <a href="https://en.wikipedia.org/wiki/Musical_temperament">Wikipedia</a> provides an excellent, succinct definition:</p>
<blockquote>
<p>A temperament is a tuning system that slightly compromises the pure intervals of just intonation to meet other requirements.</p>
</blockquote>
<p>Equal temperament does not use integer ratios. Instead, a semitone is defined to have a frequency ratio of the twelfth root of 2. This way, twelve semitones will produce a perfect octave every time. Here&#39;s what the chord from earlier sounds like under equal temperament:</p>
<p><button onclick="playChordET()">Play Chord</button></p>
<p>If you give it a listen, you might say: <em>I can still hear beating&mdash;what&#39;s the big idea?</em> You&#39;re right; under equal temperament, <em>every</em> interval besides the octave is a little bit impure. But this is where equal temperament shines: it sounds acceptable when playing in any key, while most tuning systems based on just intonation become severely dissonant in keys other than the one they&#39;re based on. This is a dealbreaker for modern music, which often makes use of modulation. Having to retune your piano every time you want to play in a different key is rather inconvenient!</p>
<aside>

<p>Of course, just intonation&#39;s shortcomings did not stop composers from incorporating key changes into their music. To accomodate these pieces, instrument makers often added extra keys that split enharmonically equivalent notes into multiple pitches. Check out this organ with 14 keys per octave:</p>
<iframe class="yt-video" width="100%" src="https://www.youtube-nocookie.com/embed/7GhAuZH6phs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

</aside>

<h1 id="coda">Coda <a class="section-link" href="#coda">&sect;</a></h1><p>The history of tuning systems and how their evolution shaped Western music is absolutely fascinating, and this article only scratches the surface. Here are some videos and articles (some of which I used as references while writing this post), in case you&#39;d like to learn more.</p>
<p>Ethan Hein&#39;s <a href="https://www.ethanhein.com/wp/2022/tuning-is-hard/">Tuning Is Hard</a> dives deep into the details of tuning with just intonation.</p>
<p>This video uses a digital keyboard to demonstrate the fundamental flaw of just intonation.</p>
<iframe class="yt-video" width="100%" src="https://www.youtube-nocookie.com/embed/Yqa2Hbb_eIs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>Remember how I claimed that tuning systems aren&#39;t as important for instruments that can change pitches on the fly? That&#39;s <em>mostly</em> true, but it&#39;s still impossible to play everything in perfect harmony. An Italian mathematician named Giambattista Benedetti demonstrated this phenomenon through a series of &quot;puzzles&quot;&mdash;repeating melodies whose pitch would become sharper and sharper if one attempted to play them using only pure intervals. Adam Neely made an excellent video on the subject:</p>
<iframe class="yt-video" width="100%" src="https://www.youtube-nocookie.com/embed/TYhPAbsIqA8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>Bach may have composed <em>The Well-Tempered Clavier</em> to demonstrate how <a href="https://en.wikipedia.org/wiki/Well_temperament">well temperament</a> (a class of tuning systems that would eventually give rise to equal temperament) enabled music written in any key to sound good. Here is a performance of the first prelude in three different temperaments, accompanied by some very enlightening explanation of each tuning system.</p>
<iframe class="yt-video" width="100%" src="https://www.youtube-nocookie.com/embed/kRui9apjWAY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>Finally, MinutePhysics made a video seven years ago which first introduced me to the mathematical problems faced by tuning and inspired this article.</p>
<iframe class="yt-video" width="100%" src="https://www.youtube-nocookie.com/embed/1Hqm0dYKUx4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>Also, <a href="https://www.youtube.com/watch?v=HXLltEn4O5E">music numbers</a>.</p>
<img id="img-view" style="display: none"><noscript><b>Please enable Javascript to view the comments on this post.</b></noscript><script src="https://utteranc.es/client.js" crossorigin="anonymous" repo="adrian154/blog" issue-term="title" label="blog-post-comments" theme="github-light"></script></main><footer><p>&copy; 2022 <a href="https://bithole.dev/">Adrian Zhang</a> &bull; <a href="/rss.xml">rss</a> &bull; <a href="https://github.com/adrian154/blog/tree/main/public/blogposts/tuning">source</a> &bull; <a href="https://creativecommons.org/licenses/by-sa/3.0/legalcode">CC BY-SA 3.0</a></p></footer></body></html>