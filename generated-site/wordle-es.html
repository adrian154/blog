<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Cheating on Spanish Wordle</title><meta property="og:title" content="Cheating on Spanish Wordle"><meta property="og:type" content="website"><meta property="og:description" content="It's as stupid as the title sounds."><meta name="description" content="It's as stupid as the title sounds."><link rel="canonical" href="https://blog.bithole.dev/wordle-es.html"><link rel="stylesheet" href="static/stylesheets/main.css"><link rel="stylesheet" href="static/stylesheets/highlight-style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"></head><body><a href="/"><img src="static/images/banner0.jpg" alt="blog banner"></a><p id="date" class="date">February 4, 2022</p><h1 style="margin-top: 0">Cheating on Spanish Wordle</h1><p>My friend recently sent me a <a href="https://wordle.danielfrg.com/">Spanish version</a> of <a href="https://www.powerlanguage.co.uk/wordle/">Wordle</a>. English Wordle simply includes all current and future solutions in the source code sent to the browser, so naturally I wondered if that was also the case for Wordle ES. What I found was quite interesting! Here&#39;s a blogpost about my attempts to disassemble this curious game, written in real time.</p>
<h1 id="first-impressions">First Impressions <a class="section-link" href="#first-impressions">&sect;</a></h1><p>The site appears to be built using <a href="https://nextjs.org/">Next.js</a>, so the source code is a frightening nightmare. Looking at the source, there&#39;s a piece of script sent along with the webpage that appears important.</p>
<pre><code class="hljs">(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">window</span>[<span class="hljs-string">&#x27;__CF$cv$params&#x27;</span>] = {
        <span class="hljs-attr">r</span>: <span class="hljs-string">&#x27;6d896d400cd59450&#x27;</span>,
        <span class="hljs-attr">m</span>: <span class="hljs-string">&#x27;5EPFU1FmlNSH_hjSJkdRx9lE5_0c8H5pqc6zJyNVesk-1644035671-0-AUNM63OowGUzDsEJsdBE03Nyoyhum2aCVewdVwQo3GfH6NrSWDSsFpr3LwJECLR4q807WjCDPC1AQVdI2/JQx8U9wP+GTjRTuQmnQEcYg6oYDsrGPQvVYUrP/OihJtRUAg==&#x27;</span>,
        <span class="hljs-attr">s</span>: [<span class="hljs-number">0x4271d96856</span>, <span class="hljs-number">0x0f8ab574ad</span>],
        <span class="hljs-attr">u</span>: <span class="hljs-string">&#x27;/cdn-cgi/challenge-platform/h/g&#x27;</span>
    }
})();</code></pre><p><em>Prettified here for your viewing pleasure.</em></p>
<p>Looks kind of like a password hash, but I doubt it&#39;s a real hash since then the code wouldn&#39;t be able to let us know which of our guessed letters were correct. Visiting <a href="https://wordle.danielfrg.com/cdn-cgi/challenge-platform/h/g">https://wordle.danielfrg.com/cdn-cgi/challenge-platform/h/g</a> yields nothing. There&#39;s two obfuscated scripts (<a href="/static/wordle-invisible.js">here</a> and <a href="/static/wordle-app.js">here</a>) that appears to implement the logic for the game. </p>
<h1 id="experimentation">Experimentation <a class="section-link" href="#experimentation">&sect;</a></h1><p>Some fiddling with devtools guides us to the code which checks if the answer is correct:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (<span class="hljs-title function_">U</span>(c), <span class="hljs-title function_">G</span>(<span class="hljs-title function_">a</span>(X).<span class="hljs-title function_">concat</span>([n])), <span class="hljs-title function_">b</span>(<span class="hljs-title function_">a</span>(S).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(r))), <span class="hljs-title function_">E</span>(<span class="hljs-title function_">a</span>(x).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(i))), <span class="hljs-title function_">T</span>(<span class="hljs-title function_">a</span>(N).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(s))), t == (<span class="hljs-number">0</span>, o.<span class="hljs-property">pe</span>)(m)) <span class="hljs-built_in">setTimeout</span>((<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-title function_">A</span>(<span class="hljs-string">&quot;WIN&quot;</span>), <span class="hljs-title function_">et</span>(<span class="hljs-title function_">a</span>(tt).<span class="hljs-title function_">concat</span>([c.<span class="hljs-property">length</span>]))
}), <span class="hljs-number">2e3</span>);
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">6</span> == c.<span class="hljs-property">length</span>) <span class="hljs-built_in">setTimeout</span>((<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-title function_">A</span>(<span class="hljs-string">&quot;LOSE&quot;</span>), <span class="hljs-title function_">et</span>(<span class="hljs-title function_">a</span>(tt).<span class="hljs-title function_">concat</span>([-<span class="hljs-number">1</span>]))
}), <span class="hljs-number">2e3</span>)</code></pre><p>Basically this code does a few things:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> e = <span class="hljs-title function_">ut</span>(t),
    n = e.<span class="hljs-property">newMatrixRow</span>,
    r = e.<span class="hljs-property">newTried</span>,
    i = e.<span class="hljs-property">newPresent</span>,
    s = e.<span class="hljs-property">newCorrect</span>,
    c = <span class="hljs-title function_">a</span>(V).<span class="hljs-title function_">concat</span>([t]);

<span class="hljs-title function_">U</span>(c)
<span class="hljs-title function_">G</span>(<span class="hljs-title function_">a</span>(X).<span class="hljs-title function_">concat</span>([n]))
<span class="hljs-title function_">b</span>(<span class="hljs-title function_">a</span>(S).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(r)))
<span class="hljs-title function_">E</span>(<span class="hljs-title function_">a</span>(x).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(i)))
<span class="hljs-title function_">T</span>(<span class="hljs-title function_">a</span>(N).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(s)))
t == (<span class="hljs-number">0</span>, o.<span class="hljs-property">pe</span>)(m)</code></pre><p>The last part appears to be the most important. We need to figure out what <code>t</code>, <code>o.pe</code>, and <code>m</code> are; nothing a quick override can&#39;t fix. <code>t</code> is just the guessed word. <code>m</code> is a base64 value, <code>U2FsdGVkX19YlMJMbsvp5tFryTPxtaJOcFpisHmdFFw=</code> at the time of writing, which decodes to mostly unprintable nonsense but is prepended with <code>Salted__</code>. It&#39;s part of an array of similar base64 values on line 6374, maybe this will become significant later. <code>o.pe</code> is this function:</p>
<pre><code class="hljs"><span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">t</span>) {
    <span class="hljs-keyword">var</span> e = <span class="hljs-title function_">i</span>().<span class="hljs-property">AES</span>.<span class="hljs-title function_">decrypt</span>(t, c).<span class="hljs-title function_">toString</span>(<span class="hljs-title function_">i</span>().<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>);
    <span class="hljs-keyword">return</span> e.<span class="hljs-title function_">startsWith</span>(u) &amp;&amp; (e = e.<span class="hljs-title function_">slice</span>(u.<span class="hljs-property">length</span>)), e
}</code></pre><p>Some more probing shows that this function returns the correct answer in plaintext! Success!</p>
<h1 id="final-touches">Final Touches <a class="section-link" href="#final-touches">&sect;</a></h1><p>Okay, now we just need to automate the process by fleshing out all the other details of this code; namely, how it gets the ciphertext, and how it picks which key to decrypt with.</p>
<p>Some quick googling suggests that the site is probably using <a href="https://www.npmjs.com/package/crypto-js">crypto-js</a> for its cryptographic primitives, meaning the array of values from earlier is probably a list of current and future ciphertexts. The key is just <code>atob(&quot;bGxhbm9z&quot;)</code>, or &quot;llanos&quot;. And finally, decrypting the list of ciphertexts reveals the full <a href="/static/wordle-words.txt">list of solutions</a>.</p>
<h1 id="closing-remarks">Closing Remarks <a class="section-link" href="#closing-remarks">&sect;</a></h1><p>The developers made a valiant effort to defend their game, but it was ultimately no match for my procrastination.</p>
<noscript><b>Please enable Javascript to view the comments on this post.</b></noscript><script src="https://utteranc.es/client.js" crossorigin="anonymous" repo="adrian154/blog" issue-term="title" label="blog-post-comments" theme="github-light"></script><p class="footnote">&copy; 2022 <a href="https://bithole.dev">Adrian Zhang</a> &bull; <a href="rss.xml">rss</a> &bull; <a href="https://github.com/adrian154/blog">contribute</a> &bull; <a href="https://creativecommons.org/licenses/by-sa/3.0/legalcode">CC BY-SA 3.0</a></p></body></html>