<!DOCTYPE html><html lang="en" class="serif"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Retrieving the Spanish Wordle Wordlist</title><meta property="og:title" content="Retrieving the Spanish Wordle Wordlist"><meta property="og:type" content="website"><meta property="og:description" content="It's as stupid as the title sounds."><meta name="description" content="It's as stupid as the title sounds."><link rel="stylesheet" href="static/stylesheets/highlight-style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><link rel="stylesheet" href="static/stylesheets/main.css"><script>const loadSetting = name => {
    if(localStorage.getItem(name) === "true")
        document.documentElement.classList.add(name);
    else
        document.documentElement.classList.remove(name);
};

loadSetting("serif");
loadSetting("darkmode");</script><script defer src="static/scripts/ui.js"></script><link rel="icon" type="image/png" sizes="16x16" href="static/images/favicon.png"><link rel="canonical" href="https://blog.bithole.dev/wordle-es.html"></head><body><header><a href="/"><img src="static/images/banner.jpg" alt="blog banner"></a></header><main><p id="date" class="date">February 4, 2022</p><h1 style="margin-top: 0">Retrieving the Spanish Wordle Wordlist</h1><nav><div id="contents"><p>Table of Contents</p><a href="#first-impressions"><p>First Impressions</p></a><a href="#experimentation"><p>Experimentation</p></a><a href="#final-touches"><p>Final Touches</p></a><a href="#closing-remarks"><p>Closing Remarks</p></a></div><button id="show-toc">&#9776; Contents</button></nav><p>My friend recently sent me a <a href="https://wordle.danielfrg.com/">Spanish version</a> of <a href="https://www.powerlanguage.co.uk/wordle/">Wordle</a>. English Wordle simply includes all current and future solutions in the source code sent to the browser, so naturally I wondered if that was also the case for Wordle ES. What I found was quite interesting! Here&#39;s a blogpost about my attempts to disassemble this curious game, written in real time.</p>
<h1 id="first-impressions">First Impressions <a class="section-link" href="#first-impressions">&sect;</a></h1><p>The site appears to be built using <a href="https://nextjs.org/">Next.js</a>, so the source code is a frightening nightmare. There&#39;s two obfuscated scripts (<a href="/resources/wordle-es/wordle-invisible.js">here</a> and <a href="/resources/wordle-es/wordle-app.js">here</a>) that appears to implement the logic for the game. </p>
<h1 id="experimentation">Experimentation <a class="section-link" href="#experimentation">&sect;</a></h1><p>Some fiddling with devtools guides us to the code which checks if the answer is correct:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (<span class="hljs-title function_">U</span>(c), <span class="hljs-title function_">G</span>(<span class="hljs-title function_">a</span>(X).<span class="hljs-title function_">concat</span>([n])), <span class="hljs-title function_">b</span>(<span class="hljs-title function_">a</span>(S).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(r))), <span class="hljs-title function_">E</span>(<span class="hljs-title function_">a</span>(x).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(i))), <span class="hljs-title function_">T</span>(<span class="hljs-title function_">a</span>(N).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(s))), t == (<span class="hljs-number">0</span>, o.<span class="hljs-property">pe</span>)(m)) <span class="hljs-built_in">setTimeout</span>((<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-title function_">A</span>(<span class="hljs-string">&quot;WIN&quot;</span>), <span class="hljs-title function_">et</span>(<span class="hljs-title function_">a</span>(tt).<span class="hljs-title function_">concat</span>([c.<span class="hljs-property">length</span>]))
}), <span class="hljs-number">2e3</span>);
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">6</span> == c.<span class="hljs-property">length</span>) <span class="hljs-built_in">setTimeout</span>((<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-title function_">A</span>(<span class="hljs-string">&quot;LOSE&quot;</span>), <span class="hljs-title function_">et</span>(<span class="hljs-title function_">a</span>(tt).<span class="hljs-title function_">concat</span>([-<span class="hljs-number">1</span>]))
}), <span class="hljs-number">2e3</span>)</code></pre><p>Basically this code does a few things:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> e = <span class="hljs-title function_">ut</span>(t),
    n = e.<span class="hljs-property">newMatrixRow</span>,
    r = e.<span class="hljs-property">newTried</span>,
    i = e.<span class="hljs-property">newPresent</span>,
    s = e.<span class="hljs-property">newCorrect</span>,
    c = <span class="hljs-title function_">a</span>(V).<span class="hljs-title function_">concat</span>([t]);

<span class="hljs-title function_">U</span>(c)
<span class="hljs-title function_">G</span>(<span class="hljs-title function_">a</span>(X).<span class="hljs-title function_">concat</span>([n]))
<span class="hljs-title function_">b</span>(<span class="hljs-title function_">a</span>(S).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(r)))
<span class="hljs-title function_">E</span>(<span class="hljs-title function_">a</span>(x).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(i)))
<span class="hljs-title function_">T</span>(<span class="hljs-title function_">a</span>(N).<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">a</span>(s)))
t == (<span class="hljs-number">0</span>, o.<span class="hljs-property">pe</span>)(m)</code></pre><p>The last part appears to be the most important. We need to figure out what <code>t</code>, <code>o.pe</code>, and <code>m</code> are; nothing a quick override can&#39;t fix. <code>t</code> is just the guessed word. <code>m</code> is a base64 value, <code>U2FsdGVkX19YlMJMbsvp5tFryTPxtaJOcFpisHmdFFw=</code> at the time of writing, which decodes to mostly unprintable nonsense but is prepended with <code>Salted__</code>. It&#39;s part of an array of similar base64 values on line 6374, maybe this will become significant later. <code>o.pe</code> is this function:</p>
<pre><code class="hljs"><span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">t</span>) {
    <span class="hljs-keyword">var</span> e = <span class="hljs-title function_">i</span>().<span class="hljs-property">AES</span>.<span class="hljs-title function_">decrypt</span>(t, c).<span class="hljs-title function_">toString</span>(<span class="hljs-title function_">i</span>().<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>);
    <span class="hljs-keyword">return</span> e.<span class="hljs-title function_">startsWith</span>(u) &amp;&amp; (e = e.<span class="hljs-title function_">slice</span>(u.<span class="hljs-property">length</span>)), e
}</code></pre><p>Some more probing shows that this function returns the correct answer in plaintext! Success!</p>
<h1 id="final-touches">Final Touches <a class="section-link" href="#final-touches">&sect;</a></h1><p>Okay, now we just need to automate the process by fleshing out all the other details of this code; namely, how it gets the ciphertext, and how it picks which key to decrypt with.</p>
<p>Some quick googling suggests that the site is probably using <a href="https://www.npmjs.com/package/crypto-js">crypto-js</a> for its cryptographic primitives, meaning the array of values from earlier is probably a list of current and future ciphertexts. The key is just <code>atob(&quot;bGxhbm9z&quot;)</code>, or &quot;llanos&quot;. And finally, decrypting the list of ciphertexts reveals the full <a href="/resources/wordle-es/wordle-words.txt">list of solutions</a>.</p>
<h1 id="closing-remarks">Closing Remarks <a class="section-link" href="#closing-remarks">&sect;</a></h1><p>The developers made a valiant effort to defend their game, but it was ultimately no match for my procrastination.</p>
<img id="img-view" style="display: none"><h1>Comments</h1><noscript><b>Please enable Javascript to view the comments on this post.</b></noscript><script src="https://utteranc.es/client.js" crossorigin="anonymous" repo="adrian154/blog" issue-term="title" label="blog-post-comments" theme="github-light"></script></main><footer><p>&copy; 2022 <a href="https://bithole.dev/">Adrian Zhang</a> &bull; <a href="rss.xml">rss</a> &bull; <a href="https://github.com/adrian154/blog">source</a> &bull; <a href="https://creativecommons.org/licenses/by-sa/3.0/legalcode">CC BY-SA 3.0</a></p></footer></body></html>