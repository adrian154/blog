<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>The Domain Name System</title><meta property="og:title" content="The Domain Name System"><meta property="og:type" content="website"><meta property="og:description" content="How does your computer figure out the IP address for a given domain? Let's find out."><meta name="description" content="How does your computer figure out the IP address for a given domain? Let's find out."><link rel="canonical" href="https://blog.bithole.dev/dns.html"><link rel="stylesheet" href="static/stylesheets/main.css"><link rel="stylesheet" href="static/stylesheets/highlight-style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"></head><body><a href="/"><img src="static/images/banner0.jpg" alt="blog banner"></a><p id="date" class="date">January 23, 2022</p><h1 style="margin-top: 0">The Domain Name System</h1><p><em><a href="internet-part-2.html">This article is part of a series.</a></em></p>
<p>When you typed <code>blog.bithole.dev</code> into your browser, it sent a request addressed towards my server at 142.93.26.121, which replied with this blogpost. But how did it know where to send the request? The answer is the <strong>domain name system</strong>, or DNS. Let&#39;s see how it works.</p>
<p>Back in the days of ARPANET, there was no DNS. Instead, there was one server, the Host Naming Registry (maintained by <a href="https://www.internethalloffame.org/inductees/elizabeth-feinler">Elizabeth Feinler</a>). If you wanted to know who was behind a domain, you would send a query to this server, and it would respond with the corresponding IP address. This worked fine for some time, but it quickly became apparent that as the nascent Internet grew, a system which scaled beyond a single node would be necessary. And thus, the present incarnation of the domain name system was born.</p>
<p>DNS is a <em>distributed database</em>, organized into a hierarchical structure. Essentially, the responsibility of answering queries for a given <em>zone</em> of the domain name space is delegated to a <em>nameserver</em>, operated by whoever is in charge of that zone. They can, in turn, delegate their own subzones. Furthermore, DNS can do more than mapping domains to IPs; there are numerous types of <strong>resource records</strong> (or just records) that can be associated with a domain, storing anything not just IPs but also metadata such as where to relay email for the domain to.</p>
<p>Every domain name represents a series of zones, separated by periods. For example, let&#39;s look at <code>wikipedia.org</code>. This domain can be split into three parts:</p>
<ul>
<li>The <strong>root zone</strong>, where the DNS namespace begins. This zone is usually omitted, but in a <em>fully qualified</em> domain name, it&#39;s indicated by the presence of an additional period at the end; for example, <code>wikipedia.org</code> is technically <code>wikipedia.org.</code>. </li>
<li><code>org</code>, the a <strong>top level domain</strong> (TLD). TLDs are administered by <a href="https://www.icann.org/">ICANN</a>.</li>
<li><code>wikipedia</code>, the final part of the domain.</li>
</ul>
<p>Each zone within a domain is serviced by its own <em>authoritative nameserver</em>, which is the ultimate source of truth for queries regarding that domain. For example, there are 13 <a href="https://en.wikipedia.org/wiki/DNS_root_zone">root nameservers</a> that serve as the topmost authorities for DNS namespace; each TLD has its own nameservers, and the same is true for domains registered at those TLDs, like <code>wikipedia.org</code>. Here&#39;s the basic &quot;thought process&quot; which all authoritative nameservers use to handle a query:</p>
<ul>
<li>If the nameserver is authoritative for the domain in question, it indicates that by setting a flag in the response message, and returns any available records that answer the query.</li>
<li>If the nameserver is not authoritative, it tries to refer the requester to a nameserver which will bring them closer to the authoritative nameserver for the domain.</li>
</ul>
<div class="info-box">

<p>While there are only 13 IPs representing the root nameservers, requests are distributed via <a href="https://en.wikipedia.org/wiki/Anycast">IP Anycast</a> to hundreds of physical servers.</p>
</div>

<p>Ultimately, there&#39;s no better way to understand something than seeing it in action, so let&#39;s get our hands dirty by acting like a DNS resolver and sending some queries. You can follow along using <a href="https://linux.die.net/man/1/dig">dig</a>, a CLI tool for making DNS requests, though I also made a <a href="TODO">web-based tool</a> for making raw DNS queries.</p>
<h1 id="iterative-dns">Iterative DNS <a class="section-link" href="#iterative-dns">&sect;</a></h1><h1 id="recursive-resolvers">Recursive Resolvers <a class="section-link" href="#recursive-resolvers">&sect;</a></h1><h1 id="reverse-dns">Reverse DNS <a class="section-link" href="#reverse-dns">&sect;</a></h1><h1 id="further-reading--references">Further Reading / References <a class="section-link" href="#further-reading--references">&sect;</a></h1><ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc1034">RFC 1034, 1035 (DNS) - IETF</a></li>
</ul>
<noscript><b>Please enable Javascript to view the comments on this post.</b></noscript><script src="https://utteranc.es/client.js" crossorigin="anonymous" repo="adrian154/blog" issue-term="title" label="blog-post-comments" theme="github-light"></script><p class="footnote">&copy; 2022 <a href="https://bithole.dev">Adrian Zhang</a> &bull; <a href="rss.xml">rss</a> &bull; <a href="https://github.com/adrian154/blog">contribute</a> &bull; <a href="https://creativecommons.org/licenses/by-sa/3.0/legalcode">CC BY-SA 3.0</a></p></body></html>
