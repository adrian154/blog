<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>So How Does the Internet Work, Anyway?</title><meta property="og:title" content="So How Does the Internet Work, Anyway?"><meta property="og:type" content="website"><meta property="og:description" content="I use the Internet a great deal, but until recently I've never really had a clear picture of what exactly makes it tick. Here is my attempt to put that to rest."><meta name="description" content="I use the Internet a great deal, but until recently I've never really had a clear picture of what exactly makes it tick. Here is my attempt to put that to rest."><link rel="canonical" href="https://blog.bithole.dev/internet.html"><link rel="stylesheet" href="static/stylesheets/main.css"><link rel="stylesheet" href="static/stylesheets/highlight-style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"></head><body><a href="/"><img src="static/images/banner0.jpg" alt="blog banner"></a><p id="date" class="date">January 4, 2022</p><h1 style="margin-top: 0">So How Does the Internet Work, Anyway?</h1><p>Some time ago, it occurred to me that I didn&#39;t <em>really</em> understand what made the Internet work. Sure, I am all too familiar with what the user experience is like, and my adventures in web development have forced me to acquire a fair bit of networking knowledge, but between the bits of light there existed vast chasms of confusion. So I decided to do some reading, some soul-searching, and publish my findings in the form of a blog post.</p>
<p>The word &quot;internet&quot; itself offers some hints about its architecture. &quot;Internet&quot; is short for <em>internetworking</em>, the act of connecting multiple computer networks so that they can communicate. That&#39;s essentially what the Internet is, a bunch of independently maintained networks that are connected such that any two computers on the Internet can reach each other.</p>
<h2 id="a-word-on-layers">A Word on Layers <a class="section-link" href="#a-word-on-layers">&sect;</a></h2><p>The Internet is powered by an ever-expanding family of technologies and protocols. These systems are segregated into layers, and each layer is responsible for providing an interface that allows the next layer to do <em>its</em> job. This layered model serves as a great way to understand the Internet starting from the ground up. In reality, the divisions between these layers are not as concrete as one would hope, and as a result there is quite a bit of disagreement over how to best model the Internet stack (primarily between supporters of the OSI model and the TCP/IP model). Since this debate is incredibly contentious, I will do my best to avoid it.</p>
<h1 id="physical-layer">Physical Layer <a class="section-link" href="#physical-layer">&sect;</a></h1><p>Let&#39;s start from the very bottom. No Internet, no networks even. Consider two computers: how can digital data be transferred from one to another? The answer to this question is the <strong>physical layer</strong>, which describes how to transmit ones and zeroes over a physical transmission medium. On top of the physical layer lies the <strong>link layer</strong>, which leverages the physical layer&#39;s capabilities to transfer full <em>frames</em> of data over a network that may be more complicated than a single point-to-point link. (The link layer may also take on other responsibilities such as error correction and retransmission.)</p>
<p>The physical layer and link layer are generally tightly coupled (out of necessity), which is the source of endless frustration. For example, the term &quot;Ethernet&quot; might refer to the physical cable standard, but it could also refer to the Ethernet protocol used to transfer frames over those cables.</p>
<p>The full answer is that Ethernet has many sublayers, which reside at varying levels within the physical and link layers. Twisted-pair Ethernet cables themselves are governed by a flock of partially agreeing standards; here&#39;s what <a href="https://en.wikipedia.org/wiki/Category_6_cable">Wikipedia</a> has to say about it:</p>
<blockquote>
<p>Confusion therefore arises because of the naming conventions and performance benchmarks laid down by the International ISO/IEC and American TIA/EIA standards, which in turn are different from the regional European standard, EN 50173-1. In broad terms, the ISO standard for Cat 6A is the most stringent, followed by the European standard, and then the American standard.</p>
</blockquote>
<p><em>That</em> is a mess that I have no interest in delving into. But Ethernet supports much more than just twisted-pair cables; it can be run over other physical media such as coaxial cable or  optical fiber. Those standards are managed by <a href="https://en.wikipedia.org/wiki/IEEE_802.3">IEEE 802.3</a>, which also handles the link-layer details of Ethernet. </p>
<p>Beyond Ethernet, there are no shortage of other ways to physically connect devices. Here are some prolific examples:</p>
<ul>
<li>WiFi (<a href="https://en.wikipedia.org/wiki/IEEE_802.11">IEEE 802.11</a>)</li>
<li>Cable (<a href="https://en.wikipedia.org/wiki/DOCSIS">DOCSIS</a>)</li>
<li><a href="https://en.wikipedia.org/wiki/LTE_(telecommunication)">LTE</a></li>
</ul>
<p>For every surviving technology, there are probably around ten dead ones. One example is <a href="https://en.wikipedia.org/wiki/Token_Ring">Token Ring</a>, IBM&#39;s Ethernet competitor that was famously vanquished around the turn of the century.</p>
<p>One thing that all <a href="https://en.wikipedia.org/wiki/IEEE_802">IEEE 802</a> technologies have in common is <strong>medium access control</strong> (<strong>MAC</strong>), which enables communication between devices on the same <strong>local area network</strong> (<strong>LAN</strong>). Each device (more accurately, each <a href="https://en.wikipedia.org/wiki/Network_interface_controller">interface</a>) is given a unique 48-bit address. These addresses are allocated by the IEEE to equipment manufacturers, though some mobile devices simply generate a <a href="https://support.apple.com/guide/security/wi-fi-privacy-secb9cb3140c/web">random MAC address</a> when connecting to a network to avoid being tracked. </p>
<p>Devices called <a href="https://en.wikipedia.org/wiki/Network_switch">network switches</a> allow communication between devices on the same LAN. A switch is basically an embedded device with a large number of Ethernet ports. Because all devices on the network communicate with each other by talking through the switch, a <a href="https://en.wikipedia.org/wiki/Star_network">star topology</a> is formed.</p>
<p><img src="static/images/switch-star-topology.png" alt="star topology diagram"></p>
<p><em>In case you can&#39;t tell, I&#39;m not exactly the best at making diagrams.</em></p>
<p>When computer A wants to send a message to computer B, it sends a frame to the switch; the frame header indicates that its destination is computer B&#39;s MAC address. However, the switch doesn&#39;t know which physical port the connection to computer B is located on, so it relays the frame to all connected computers, hoping that one of them is the intended recipient. When computer B receives the frame, it might reply with another frame. Since each frame has the sender&#39;s MAC address as well as the recipient&#39;s, when the switch receives a frame from computer B it will associate the port that computer B is connected on with computer B&#39;s MAC address, and in the future when the switch receives a frame with computer B as its destination it can simply relay the frame on the correct link instead of <em>flooding</em>.</p>
<div class="info-box">

<p>Back in the day, when everything was slightly worse, networks were often created using <a href="https://en.wikipedia.org/wiki/Ethernet_hub">hubs</a> instead of switches. Hubs are much simpler devices which simply retransmit everything that it receives to all other devices. Because of their relative lack of sophistication, hubs suffer from a littany of problems:</p>
<ul>
<li>Since every device needs to be able to receive the data being transmitted by the hub, if one device was slower than the others, <em>every</em> link on the switch would be forced to operate at that speed.</li>
<li>Multiple devices trying to transmit at the same time would result in a garbled mess being transmitted (a condition known as a <a href="https://en.wikipedia.org/wiki/Carrier-sense_multiple_access_with_collision_detection">collision</a>), requiring the hub to detect the conflict and temporarily stop all transmissions. This obviously degraded network performance.</li>
</ul>
<p>Today, hubs have been made obsolete in favor of switches and are rarely used outside of special conditions (though evidently my school&#39;s IT department hasn&#39;t gotten the memo). Even in the early days of Ethernet, it was apparent that collisions posed a challenging problem, so other protocols approached access control differently. For example, in Token Ring setups, there is no central switch or hub; nodes are connected in a ring, and transmission rights are passed around the ring. When one node is done transmitting, it passes the <em>token</em> to the next node. Hence the name, Token Ring. *roll credits*</p>
</div>

<p>Switches are one of the most ubiquitous building blocks of computer networks, so it&#39;s no surprise that they are all over the place. If your router has more than one Ethernet port, chances are it has a built-in switch.</p>
<h2 id="wifi">WiFi <a class="section-link" href="#wifi">&sect;</a></h2><p>An overview of physical-layer protocols just wouldn&#39;t be complete without a mention to WiFi, standardized by <a href="https://en.wikipedia.org/wiki/IEEE_802.11">IEEE 802.11</a>. The idea of a point-to-point link starts to break down when it comes to wireless communications because radio signals will propagate to every connected device whether you like it or not. Thus, WiFi networks use an algorithm called <a href="https://en.wikipedia.org/wiki/Multiple_Access_with_Collision_Avoidance">Multiple Access with Collision Avoidance</a> to ensure that only one device tries to transmit data at a time. Receiving frames is simpler; devices simply decode all incoming frames and pick out the ones that are actually destined towards their MAC address. In this way, a WiFi network functions more closely to an Ethernet hub than a switch.</p>
<p>In this situation, no router or switch is necessary to relay messages between devices on the same WLAN. In fact, any WiFi-capable transceiver can <a href="https://en.wikipedia.org/wiki/Wireless_ad_hoc_network">broadcast a network</a>; in fact, Windows <a href="https://answers.microsoft.com/en-us/windows/forum/all/how-do-i-set-up-an-ad-hoc-wifi-network-in-windows/0caa92d8-e02f-4e7f-aa5c-0abf10ed2039">natively supports</a> this feature! Instead, your router plays the role of a <a href="https://en.wikipedia.org/wiki/Wireless_access_point">wireless access point</a>, aptly abbreviated to <strong>WAP</strong>. (In light of &quot;WAP&quot; becoming rather vulgar in recent years, I will use the more succinct abbreviation of just <strong>AP</strong> for the rest of this post.) The role of an AP is simple; it just serves as an interface between the wireless network and the regular wired network, which has access to the public Internet. Speaking of which...</p>
<h1 id="internet-layer">Internet Layer <a class="section-link" href="#internet-layer">&sect;</a></h1><p>We&#39;ve finally reached the Internet layer of the Internet. This is where all the action happens! Buckle up, and let&#39;s explore how it works.</p>
<p>Relatively few protocols live in the Internet layer. Its primary inhabitants are the <a href="https://en.wikipedia.org/wiki/Internet_Protocol">Internet Protocol</a> (IP) and <a href="https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol">Internet Control Message Protocol</a> (ICMP). There are two currently deployed versions of IP, IPv4 and IPv6, which are generally very similar but vary in subtle yet important ways.</p>
<p>In IP, every network interface (usually just one per computer) is associated with an IP address. In IPv4, this address is 32-bits long, and usually written as a series of four numbers (each corresponding to a byte of the IP address) separated by periods. For example, the IP of this blog at the time of writing is 142.93.26.121. Because IPv4 addresses are only 32 bits long, there can only be 2<sup>32</sup> = ~4 billion unique IPv4 addresses. That seems like a lot, but as early as the 90s the threat of <a href="https://en.wikipedia.org/wiki/IPv4_address_exhaustion">running out of IPv4 addresses</a> has continually loomed over the Internet, made worse by the fact that many parts of IPv4 space are <a href="https://en.wikipedia.org/wiki/Reserved_IP_addresses">reserved</a> for various purposes. To fix this issue, IPv6 was created. IPv6 addresses are 128 bits long, which is more than enough to serve humanity&#39;s needs at the moments. (If all IPv6 addresses were distributed equally among all living humans, every individual could have 47 octillion addresses. We won&#39;t be running out any time soon, especially because sadly a lot of the Internet is still stuck on IPv4.)</p>
<div class="info-box">

<p><em>Why can&#39;t MAC addresses just be used for routing?</em>, you might ask. The biggest reason is that IP is meant to be mostly agnostic of the protocols used in the underlying link layer. Using MAC addresses would violate that principle; networks not running on IEEE 802 technologies wouldn&#39;t be able to join the Internet, which defeats its whole purpose of connecting numerous heterogeneous networks.</p>
</div><script src="https://utteranc.es/client.js" crossorigin="anonymous" repo="adrian154/blog" issue-term="title" label="blog-post-comments" theme="github-light"></script><p class="footnote">&copy; 2022 Adrian Zhang &bull; <a href="https://bithole.dev/">about me</a> &bull; <a href="https://github.com/adrian154/blog">contribute</a></p></body></html>